"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3277],{2713:(e,t,a)=>{a.d(t,{CreateFirstUserClient:()=>u});var n=a(67252),i=a(66797),l=a(59535),r=a(45749),s=a(697),o=a(89688);let u=e=>{let{docPermissions:t,docPreferences:a,initialState:u,loginWithUsername:c,userSlug:d}=e,{config:{routes:{admin:m,api:h},serverURL:p},getEntityConfig:g}=(0,i.b)(),{getFormState:f}=(0,l.useServerFunctions)(),{t:v}=(0,r.d)(),{setUser:x}=(0,l.useAuth)(),w=o.useRef(null),j=g({collectionSlug:d}),b=o.useCallback(async e=>{let{formState:n,submitted:i}=e,l=(0,s.wN)(w),r=await f({collectionSlug:d,docPermissions:t,docPreferences:a,formState:n,operation:"create",schemaPath:d,signal:l.signal,skipValidation:!i});if(w.current=null,r&&r.state)return r.state},[d,f,t,a]);return(0,o.useEffect)(()=>{let e=w.current;return()=>{(0,s.eS)(e)}},[]),(0,n.jsxs)(l.Form,{action:"".concat(p).concat(h,"/").concat(d,"/first-register"),initialState:u,method:"POST",onChange:[b],onSuccess:e=>{x(e)},redirect:m,validationOperation:"create",children:[(0,n.jsx)(l.EmailAndUsernameFields,{className:"emailAndUsername",loginWithUsername:c,operation:"create",readOnly:!1,t:v}),(0,n.jsx)(l.PasswordField,{autoComplete:"off",field:{name:"password",label:v("authentication:newPassword"),required:!0},path:"password"}),(0,n.jsx)(l.ConfirmPasswordField,{}),(0,n.jsx)(l.RenderFields,{fields:j.fields,forceRender:!0,parentIndexPath:"",parentPath:"",parentSchemaPath:d,permissions:!0,readOnly:!1}),(0,n.jsx)(l.FormSubmit,{size:"large",children:v("general:create")})]})}},15445:(e,t,a)=>{a.d(t,{LoginForm:()=>g});var n=a(47092),i=a(67252),l=a(89688),r=a(66797),s=a(45749),o=a(59535);let u=e=>({canLoginWithEmail:!e||e.allowEmailLogin,canLoginWithUsername:!!e}),c=({allowAbsoluteUrls:e=!1,fallbackTo:t="/",redirectTo:a})=>{let n;if("string"!=typeof a)return t;try{n=decodeURIComponent(a.trim())}catch{return t}let i=n.startsWith("/")&&!n.startsWith("//")&&!n.startsWith("/%2F")&&!n.startsWith("/\\/")&&!n.startsWith("/\\\\")&&!n.startsWith("/\\")&&!n.toLowerCase().startsWith("/javascript:")&&!n.toLowerCase().startsWith("/http"),l=e&&/^https?:\/\/\S+$/i.test(n);return i||l?n:t};var d=a(69020),m=a(20091);let h=e=>{let t=(0,n.c)(11),{type:a,required:l}=e,r=void 0===l||l,{t:u}=(0,s.d)();if("email"===a){let e;return t[0]!==r||t[1]!==u?(e=(0,i.jsx)(o.EmailField,{field:{name:"email",admin:{autoComplete:"email"},label:u("general:email"),required:r},path:"email",validate:m.Rp}),t[0]=r,t[1]=u,t[2]=e):e=t[2],e}if("username"===a){let e;return t[3]!==r||t[4]!==u?(e=(0,i.jsx)(o.TextField,{field:{name:"username",label:u("authentication:username"),required:r},path:"username",validate:m.Xh}),t[3]=r,t[4]=u,t[5]=e):e=t[5],e}if("emailOrUsername"===a){let e;if(t[6]!==r||t[7]!==u){let a;t[9]!==u?(a=(e,t)=>{let a=(0,m.Xh)(e,t),n=(0,m.Rp)(e,t);return!!n||!!a||"".concat(u("general:email"),": ").concat(n," ").concat(u("general:username"),": ").concat(a)},t[9]=u,t[10]=a):a=t[10],e=(0,i.jsx)(o.TextField,{field:{name:"username",label:u("authentication:emailOrUsername"),required:r},path:"username",validate:a}),t[6]=r,t[7]=u,t[8]=e}else e=t[8];return e}return null},p="login__form",g=e=>{let t,a,m,g,f=(0,n.c)(23),{prefillEmail:v,prefillPassword:x,prefillUsername:w,searchParams:j}=e,{config:b,getEntityConfig:S}=(0,r.b)(),{admin:F,routes:y}=b,{routes:P,user:C}=F,{forgot:R}=P,{admin:k,api:T}=y;if(f[0]!==S||f[1]!==C){let{auth:e}=S({collectionSlug:C});a=u(t=e.loginWithUsername),f[0]=S,f[1]=C,f[2]=t,f[3]=a}else t=f[2],a=f[3];let{canLoginWithEmail:E,canLoginWithUsername:W}=a;f[4]!==E||f[5]!==W?(m=()=>E&&W?"emailOrUsername":W?"username":"email",f[4]=E,f[5]=W,f[6]=m):m=f[6];let[O]=l.useState(m),{t:_}=(0,s.d)(),{setUser:U}=(0,o.useAuth)(),q=null!=x?x:void 0,L=null!=x?x:void 0;if(f[7]!==k||f[8]!==T||f[9]!==R||f[10]!==O||f[11]!==t||f[12]!==v||f[13]!==w||f[14]!==(null==j?void 0:j.redirect)||f[15]!==U||f[16]!==_||f[17]!==q||f[18]!==L||f[19]!==C){let e,a={password:{initialValue:q,valid:!0,value:L}};t?a.username={initialValue:null!=w?w:void 0,valid:!0,value:null!=w?w:void 0}:a.email={initialValue:null!=v?v:void 0,valid:!0,value:null!=v?v:void 0},f[21]!==U?(e=e=>{U(e)},f[21]=U,f[22]=e):e=f[22];let n=e;g=(0,i.jsxs)(o.Form,{action:"".concat(T,"/").concat(C,"/login"),className:p,disableSuccessStatus:!0,initialState:a,method:"POST",onSuccess:n,redirect:c({fallbackTo:k,redirectTo:null==j?void 0:j.redirect}),waitForAutocomplete:!0,children:[(0,i.jsxs)("div",{className:"".concat(p,"__inputWrap"),children:[(0,i.jsx)(h,{type:O}),(0,i.jsx)(o.PasswordField,{field:{name:"password",label:_("general:password"),required:!0},path:"password"})]}),(0,i.jsx)(o.Link,{href:(0,d.Q)({adminRoute:k,path:R}),prefetch:!1,children:_("authentication:forgotPasswordQuestion")}),(0,i.jsx)(o.FormSubmit,{size:"large",children:_("authentication:login")})]}),f[7]=k,f[8]=T,f[9]=R,f[10]=O,f[11]=t,f[12]=v,f[13]=w,f[14]=null==j?void 0:j.redirect,f[15]=U,f[16]=_,f[17]=q,f[18]=L,f[19]=C,f[20]=g}else g=f[20];return g}},22115:(e,t,a)=>{a.d(t,{ForgotPasswordForm:()=>d});var n=a(47092),i=a(67252),l=a(66797),r=a(45749),s=a(59535),o=a(20091),u=a(89688);function c({description:e,heading:t}){return t?(0,i.jsxs)("div",{className:"form-header",children:[(0,i.jsx)("h1",{children:t}),!!e&&(0,i.jsx)("p",{children:e})]}):null}let d=()=>{var e;let t,a,d,m,h=(0,n.c)(17),{config:p,getEntityConfig:g}=(0,l.b)(),{admin:f,routes:v}=p,{user:x}=f,{api:w}=v,{t:j}=(0,r.d)(),[b,S]=(0,u.useState)(!1);h[0]!==g||h[1]!==x?(t=g({collectionSlug:x}),h[0]=g,h[1]=x,h[2]=t):t=h[2];let F=t,y=null==F||null==(e=F.auth)?void 0:e.loginWithUsername;h[3]!==y||h[4]!==j?(a=(e,t,a)=>{e.json().then(()=>{S(!0),t(j("general:submissionSuccessful"))}).catch(()=>{a(y?j("authentication:usernameNotValid"):j("authentication:emailNotValid"))})},h[3]=y,h[4]=j,h[5]=a):a=h[5];let P=a;if(h[6]!==w||h[7]!==p||h[8]!==P||h[9]!==b||h[10]!==y||h[11]!==j||h[12]!==x){m=Symbol.for("react.early_return_sentinel");e:{let e=y?{username:{initialValue:"",valid:!0,value:void 0}}:{email:{initialValue:"",valid:!0,value:void 0}};if(b){let e;h[15]!==j?(e=(0,i.jsx)(c,{description:j("authentication:checkYourEmailForPasswordReset"),heading:j("authentication:emailSent")}),h[15]=j,h[16]=e):e=h[16],m=e;break e}d=(0,i.jsxs)(s.Form,{action:"".concat(w,"/").concat(x,"/forgot-password"),handleResponse:P,initialState:e,method:"POST",children:[(0,i.jsx)(c,{description:y?j("authentication:forgotPasswordUsernameInstructions"):j("authentication:forgotPasswordEmailInstructions"),heading:j("authentication:forgotPassword")}),y?(0,i.jsx)(s.TextField,{field:{name:"username",label:j("authentication:username"),required:!0},path:"username",validate:e=>(0,o.Qq)(e,{name:"username",type:"text",blockData:{},data:{},event:"onChange",path:["username"],preferences:{fields:{}},req:{payload:{config:p},t:j},required:!0,siblingData:{}})}):(0,i.jsx)(s.EmailField,{field:{name:"email",admin:{autoComplete:"email"},label:j("general:email"),required:!0},path:"email",validate:e=>(0,o.Rp)(e,{name:"email",type:"email",blockData:{},data:{},event:"onChange",path:["email"],preferences:{fields:{}},req:{payload:{config:p},t:j},required:!0,siblingData:{}})}),(0,i.jsx)(s.FormSubmit,{size:"large",children:j("general:submit")})]})}h[6]=w,h[7]=p,h[8]=P,h[9]=b,h[10]=y,h[11]=j,h[12]=x,h[13]=d,h[14]=m}else d=h[13],m=h[14];return m!==Symbol.for("react.early_return_sentinel")?m:d}},28175:(e,t,a)=>{a.d(t,{AccountClient:()=>s});var n=a(47092),i=a(59535),l=a(45749),r=a(89688);let s=()=>{let e,t,a=(0,n.c)(4),{setStepNav:s}=(0,i.useStepNav)(),{t:o}=(0,l.d)();return a[0]!==s||a[1]!==o?(e=()=>{let e=[];e.push({label:o("authentication:account"),url:"/account"}),s(e)},t=[s,o],a[0]=s,a[1]=o,a[2]=e,a[3]=t):(e=a[2],t=a[3]),r.useEffect(e,t),null}},35142:(e,t,a)=>{a.d(t,{ResetPreferences:()=>c});var n=a(47092),i=a(67252),l=a(59535),r=a(45749),s=a(96900),o=a(89688);let u="confirm-reset-modal",c=e=>{let t,a,c,d=(0,n.c)(9),{apiRoute:m,user:h}=e,{openModal:p}=(0,l.useModal)(),{t:g}=(0,r.d)();d[0]!==m||d[1]!==h?(t=async()=>{if(!h)return;let e=s.A({depth:0,where:{user:{id:{equals:h.id}}}},{addQueryPrefix:!0});try{let t=await fetch("".concat(m,"/payload-preferences").concat(e),{credentials:"include",headers:{"Content-Type":"application/json"},method:"DELETE"}),a=(await t.json()).message;t.ok?l.toast.success(a):l.toast.error(a)}catch(e){}},d[0]=m,d[1]=h,d[2]=t):t=d[2];let f=t;return d[3]!==p?(a=()=>p(u),d[3]=p,d[4]=a):a=d[4],d[5]!==f||d[6]!==g||d[7]!==a?(c=(0,i.jsxs)(o.Fragment,{children:[(0,i.jsx)("div",{children:(0,i.jsx)(l.Button,{buttonStyle:"secondary",onClick:a,children:g("general:resetPreferences")})}),(0,i.jsx)(l.ConfirmationModal,{body:g("general:resetPreferencesDescription"),confirmingLabel:g("general:resettingPreferences"),heading:g("general:resetPreferences"),modalSlug:u,onConfirm:f})]}),d[5]=f,d[6]=g,d[7]=a,d[8]=c):c=d[8],c}},43128:(e,t,a)=>{a.d(t,{LogoutClient:()=>c});var n=a(47092),i=a(67252),l=a(59535),r=a(45749),s=a(98034),o=a(69020),u=a(89688);let c=e=>{let t,a,c,d,m,h=(0,n.c)(23),{adminRoute:p,inactivity:g,redirect:f}=e,{logOut:v,user:x}=(0,l.useAuth)(),{startRouteTransition:w}=(0,l.useRouteTransition)(),[j,b]=u.useState(!x),S=u.useRef(!1);h[0]!==p||h[1]!==g||h[2]!==f?(t=()=>(0,o.Q)({adminRoute:p,path:"/login".concat(g&&f&&f.length>0?"?redirect=".concat(encodeURIComponent(f)):"")}),h[0]=p,h[1]=g,h[2]=f,h[3]=t):t=h[3];let[F]=u.useState(t),{t:y}=(0,r.d)(),P=(0,s.useRouter)();h[4]!==g||h[5]!==v||h[6]!==F||h[7]!==P||h[8]!==w||h[9]!==y?(a=async()=>{let e=await v();if(b(e),!g&&e&&!S.current){l.toast.success(y("authentication:loggedOutSuccessfully")),S.current=!0,w(()=>P.push(F));return}},h[4]=g,h[5]=v,h[6]=F,h[7]=P,h[8]=w,h[9]=y,h[10]=a):a=h[10];let C=a;if(h[11]!==C||h[12]!==j||h[13]!==F||h[14]!==P||h[15]!==w?(c=()=>{j?w(()=>P.push(F)):C()},d=[C,j,F,P,w],h[11]=C,h[12]=j,h[13]=F,h[14]=P,h[15]=w,h[16]=c,h[17]=d):(c=h[16],d=h[17]),(0,u.useEffect)(c,d),j&&g){let e;return h[18]!==F||h[19]!==y?(e=(0,i.jsxs)("div",{className:"".concat("logout","__wrap"),children:[(0,i.jsx)("h2",{children:y("authentication:loggedOutInactivity")}),(0,i.jsx)(l.Button,{buttonStyle:"secondary",el:"link",size:"large",url:F,children:y("authentication:logBackIn")})]}),h[18]=F,h[19]=y,h[20]=e):e=h[20],e}return h[21]!==y?(m=(0,i.jsx)(l.LoadingOverlay,{animationDuration:"0ms",loadingText:y("authentication:loggingOut")}),h[21]=y,h[22]=m):m=h[22],m}},45528:(e,t,a)=>{a.d(t,{ToggleTheme:()=>o});var n=a(47092),i=a(67252),l=a(66797),r=a(45749),s=a(59535);a(89688);let o=()=>{let e,t,a=(0,n.c)(7),{autoMode:o,setTheme:u,theme:c}=(0,l.h)(),{t:d}=(0,r.d)();a[0]!==u?(e=e=>{u(e)},a[0]=u,a[1]=e):e=a[1];let m=e;return a[2]!==o||a[3]!==m||a[4]!==d||a[5]!==c?(t=(0,i.jsx)(s.RadioGroupField,{disableModifyingForm:!0,field:{name:"theme",label:d("general:adminTheme"),options:[{label:d("general:automatic"),value:"auto"},{label:d("general:light"),value:"light"},{label:d("general:dark"),value:"dark"}]},onChange:m,path:"theme",value:o?"auto":c}),a[2]=o,a[3]=m,a[4]=d,a[5]=c,a[6]=t):t=a[6],t}},83972:(e,t,a)=>{a.d(t,{ResetPasswordForm:()=>d});var n=a(47092),i=a(67252),l=a(45749),r=a(66797),s=a(59535),o=a(98034),u=a(69020);a(89688);let c={"confirm-password":{initialValue:"",valid:!1,value:""},password:{initialValue:"",valid:!1,value:""}},d=e=>{let t,a,d=(0,n.c)(11),{token:m}=e,h=(0,l.d)(),{config:p}=(0,r.b)(),{admin:g,routes:f,serverURL:v}=p,{routes:x,user:w}=g,{login:j}=x,{admin:b,api:S}=f,F=(0,o.useRouter)(),{fetchFullUser:y}=(0,s.useAuth)();d[0]!==b||d[1]!==y||d[2]!==F||d[3]!==j?(t=async()=>{await y()?F.push(b):F.push((0,u.Q)({adminRoute:b,path:j}))},d[0]=b,d[1]=y,d[2]=F,d[3]=j,d[4]=t):t=d[4];let P=t,C="".concat(v).concat(S,"/").concat(w,"/reset-password");return d[5]!==h||d[6]!==P||d[7]!==C||d[8]!==m||d[9]!==w?(a=(0,i.jsxs)(s.Form,{action:C,initialState:c,method:"POST",onSuccess:P,children:[(0,i.jsxs)("div",{className:"inputWrap",children:[(0,i.jsx)(s.PasswordField,{field:{name:"password",label:h.t("authentication:newPassword"),required:!0},path:"password",schemaPath:"".concat(w,".password")}),(0,i.jsx)(s.ConfirmPasswordField,{}),(0,i.jsx)(s.HiddenField,{path:"token",schemaPath:"".concat(w,".token"),value:m})]}),(0,i.jsx)(s.FormSubmit,{size:"large",children:h.t("authentication:resetPassword")})]}),d[5]=h,d[6]=P,d[7]=C,d[8]=m,d[9]=w,d[10]=a):a=d[10],a}},88761:(e,t,a)=>{a.d(t,{ToastAndRedirect:()=>s});var n=a(47092),i=a(59535),l=a(98034),r=a(89688);function s(e){let t,a,s=(0,n.c)(6),{message:o,redirectTo:u}=e,c=(0,l.useRouter)(),{startRouteTransition:d}=(0,i.useRouteTransition)(),m=r.useRef(!1);return s[0]!==o||s[1]!==u||s[2]!==c||s[3]!==d?(t=()=>{let e;return i.toast&&(e=setTimeout(()=>{i.toast.success(o),m.current=!0,d(()=>c.push(u))},100)),()=>{e&&clearTimeout(e)}},a=[c,u,o,d],s[0]=o,s[1]=u,s[2]=c,s[3]=d,s[4]=t,s[5]=a):(t=s[4],a=s[5]),(0,r.useEffect)(t,a),null}},99187:(e,t,a)=>{a.d(t,{LanguageSelector:()=>s});var n=a(47092),i=a(67252),l=a(45749),r=a(59535);a(89688);let s=e=>{let t,a,s=(0,n.c)(8),{languageOptions:o}=e,{i18n:u,switchLanguage:c}=(0,l.d)();if(s[0]!==c?(t=async e=>{await c(e.value)},s[0]=c,s[1]=t):t=s[1],s[2]!==u||s[3]!==o||s[4]!==t){let e;s[6]!==u?(e=e=>e.value===u.language,s[6]=u,s[7]=e):e=s[7],a=(0,i.jsx)(r.ReactSelect,{inputId:"language-select",isClearable:!1,onChange:t,options:o,value:o.find(e)}),s[2]=u,s[3]=o,s[4]=t,s[5]=a}else a=s[5];return a}}}]);